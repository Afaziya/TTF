package ru.tomtrix.ttf

import ru.tomtrix.ttf.SWTWrappers._
import ru.tomtrix.ttf.patterns.Disposable._
import org.eclipse.swt.widgets.{Shell, Display}
import patterns.{Repository, Akka}

object Exploit {
  def exploitAkka(sysName: String)(f: Akka => Unit) {
    using(new Akka{val name = sysName})(f)
  }

  def exploitDb(dbmsname: DBMS, dbname: String)(f: Repository => Unit) {
    using(new Repository {val db: String = dbname; val dbms: DBMS = dbmsname})(f)
  }

  def exploitSplash(splashname: String, splashtext: String, splashtimeMillis: Int)(f: Shell => Unit) {
    showSplashScreenFuncTime(splashname, text = splashtext, millisec = splashtimeMillis)(f)
  }

  def exploitForm(title: String)(f: Shell => Unit) {
    val display = new Display()
    val shell = new Shell(display)
    shell.setText(title)
    shell.setSize(500, 350)
    shell.setLocation(display.getBounds.width/2 - shell.getSize.x/2, display.getBounds.height/2 - shell.getSize.y/2 - 20)
    f(shell)
    shell.open()
    while (!shell.isDisposed)
      if (!display.readAndDispatch()) display sleep()
  }
}
